<div class="col-12 mb-4 px-4 rounded gridCustom">

    @(
        Html.Kendo().Grid<GuanajuatoAdminUsuarios.Models.CapturaAccidentesModel>()
        .Name("gridFactores")
        .Columns(columns =>
        {
            columns.Bound(c => c.FactorAccidente).Title("Factor").Width(120);
            columns.Bound(c => c.FactorOpcionAccidente).Title("Opcion").Width(120);
            columns.Template("<button data-bs-toggle=modal  class='w-100 btn' onclick='mostrarModalEditarFactor()'><h6 class='m-0 colorPrimary'><i class='h5 icon-edit me-2'></i><b>Editar</b></h6></button>").Width(150);
            columns.Template("<button data-bs-toggle='modal' class='w-100 btn'><h6 class='m-0 colorDanger' onclick='mostrarModalEliminarFactor(event)'><i class='h5 icon-delete me-2'></i><b>Eliminar</b></h6></button>").Width(150);

        }).HtmlAttributes(new { style = "height:250px" })
        .Sortable()
        .Groupable()

        .Scrollable()
        .Pageable()
        .DataSource(dataSource => dataSource
        .Ajax()
        .Read(read => read.Action("AgregarFactorNuevo", "CapturaAccidentes"))
        .PageSize(5).Model(model => model.Id(p => p.IdAccidente))
        )
        .ToolBar(t => t.Search())
        .Search(s =>
        {
            s.Field(c => c.FactorAccidente);
            s.Field(c => c.FactorOpcionAccidente);
        })

        .Selectable(selectable => selectable.Mode(GridSelectionMode.Single)
        .Type(GridSelectionType.Row)
        )
        )

</div>
<!--Modal editar factor accidente-->
<div class="modal fade modalCustom" id="editarFactorAccidenteModal" tabindex="-1" aria-labelledby="agregarVehiculoLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-body" id="ModalBodyEditarFactorAccidente">
            </div>
        </div>
    </div>
</div>
<!--Modal eliminar factor accidente-->
<div class="modal fade modalCustom" id="eliminarFactorAccidenteModal" tabindex="-1" aria-labelledby="agregarVehiculoLabel" aria-hidden="true">
    <div class="modal-dialog modal-s" role="document">
        <div class="modal-content">
            <div class="modal-body" id="ModalBodyEliminarFactorAccidente">
            </div>
        </div>
    </div>
</div>
<script>
 function mostrarModalEditarFactor() {
        $.ajax({
            url: '@Url.Action("ModalEditarFactorAccidente")',
            type: 'POST',
            contentType: "application/json; charset=utf-8",
            dataType: "html",
            success: function (data) {
                $('#ModalBodyEditarFactorAccidente').html(data);
                $('#editarFactorAccidenteModal').modal('show');
            }
        });
    }

    function mostrarModalEliminarFactor(event) {
        var grid = $("#gridFactores").data("kendoGrid");
        var row = $(event.target).closest("tr");
        var dataItem = grid.dataItem(row);
        console.log("INFO", dataItem);

        $.ajax({
            url: '@Url.Action("ModalEliminarFactorAccidente")',
            type: 'POST',
            contentType: "application/json; charset=utf-8",
            dataType: "html",
            data: JSON.stringify(dataItem), 
            success: function (data) {
                $('#ModalBodyEliminarFactorAccidente').html(data);
                $('#eliminarFactorAccidenteModal').modal('show');
            }
        });
    }


    function factoresChangeEdit() {
        var factorDDValue = $("#IdFactorAccidente").data("kendoDropDownList").value();
        $.ajax({
            url: "/CapturaAccidentes/FactoresOpciones_Drop",
            type: "POST",
            data: { factorDDValue: factorDDValue },
            success: function (data) {
                var FactorOpcionDropDown = $("#IdFactorOpcionAccidente").data("kendoDropDownList");
                FactorOpcionDropDown.dataSource.data(data);
            },
            error: function (xhr, status, error) {
            }
        });
    }

</script>